<?xml version="1.0" encoding="utf-8"?>

<rules>
	<!-- Here we attempt to guess the conjugation class, which has the highest
	     likelyhood of being inaccurate. -->
	<rule-set name="entry.verb.option.conjugation">
		<get-dictionary-form/>

		<switch>
			<case>
				<or>
					<ends-in letters="o,w,a,c'"/>
					<ends-in letters="i,w,a,c'"/>
					<ends-in letters="a,w,a,c'"/>
					<ends-in letters="y,w,a,c'"/>
				</or>

				<return value="first"/>
			</case>
			<case>
				<or>
					<ends-in letters="a,c'"/>
					<ends-in letters="i,e,c'"/>
				</or>

				<return value="third"/>
			</case>
			<case>
				<or>
					<ends-in letters="i,c'"/>
					<ends-in letters="y,c'"/>
					<ends-in letters="e,c'"/>
				</or>

				<return value="second"/>
			</case>
		</switch>
	</rule-set>

	<!-- Now, we attempt to guess the verb stem using what we know about the conjugation
	     class.  This has the second highest likelyhood of being a bad guess. -->
	<rule-set name="entry.verb.form.stem">
		<get-dictionary-form/>

		<switch>
			<case>
				<and>
					<or>
						<ends-in letters="o,w,a,c'"/>
						<ends-in letters="i,w,a,c'"/>
						<ends-in letters="y,w,a,c'"/>
					</or>

					<!-- if we manually set the verb to third conjugation then 
					     don't do the -uj transformation. -->
					<not>
						<entry-option name="conjugation" value="third"/>
					</not>
				</and>

				<replace-letters letters="u"/>
			</case>
			<case>
				<ends-in letters="a,w,a,c'"/>
				<replace-letters letters="a"/>
			</case>
			<case>
				<ends-in letters="c'"/>
				<remove-letters index="-1,"/>
			</case>
		</switch>

		<if>
			<and>
				<entry-option name="conjugation" value="second"/>
				<ends-in letters="e"/>
			</and>

			<replace-letters letters="y"/>
		</if>

		<if>
			<and>
				<or>
					<entry-option name="conjugation" value="first"/>
					<entry-option name="conjugation" value="third"/>
				</or>
				<ends-in classes="vowel"/>
			</and>

			<append-letters letters="j"/>
		</if>
	</rule-set>

	<rule-set name="entry.verb.form.nonpast.singular.1p">
		<get-form name="stem"/>

		<switch>
			<case>
				<entry-option name="conjugation" value="third"/>

				<remove-letters index="-1,"/>
				<append-letters letters="m"/>
			</case>
			<case>
				<always/>

				<if>
					<ends-in letters="y"/>
					<remove-letters index="-1,"/>
				</if>

				<append-letters letters="e_"/>
			</case>
		</switch>
	</rule-set>

	<rule-set name="entry.verb.form.nonpast.singular.2p">
		<get-form name="nonpast.singular.3p"/>
		<append-letters letters="sz"/>
	</rule-set>

	<rule-set name="entry.verb.form.nonpast.singular.3p">
		<get-form name="stem"/>

		<switch>
			<case>
				<entry-option name="conjugation" value="first"/>
				<append-letters letters="e"/>
			</case>
			<case>
				<and>
					<entry-option name="conjugation" value="third"/>
					<!--
					<ends-in classes="consonant"/>
					-->
				</and>

				<remove-letters index="-1,"/>
			</case>
		</switch>
	</rule-set>

	<rule-set name="entry.verb.form.nonpast.plural.1p">
		<get-form name="nonpast.singular.3p"/>
		<append-letters letters="m,y"/>
	</rule-set>

	<rule-set name="entry.verb.form.nonpast.plural.2p">
		<get-form name="nonpast.singular.3p"/>
		<append-letters letters="c,i,e"/>
	</rule-set>

	<rule-set name="entry.verb.form.nonpast.plural.3p">
		<get-form name="stem"/>

		<if>
			<ends-in letters="y"/>
			<remove-letters index="-1,"/>
		</if>

		<append-letters letters="a_"/>
	</rule-set>
</rules>

